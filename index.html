<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Bonnier Task</title>
  </head>
  <body>
    <h1>Bonnier metadata</h1>
    <div id="listings"></div>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
          const displayElement = document.getElementById('listings')

          const displayListings = data => {
              const listings = data.newsPlayer.assets
              listings.forEach(listing => {
                  let el = document.createElement('div')
                  el.dataset.id = listing.id
                  el.innerHTML = `<h1>${listing.program_nid}</h1><p>${listing.description}</p>`
                  displayElement.appendChild(el)
              });
          }

          displayElement.addEventListener('click', event => {
              alert(`You clicked on ${event.target.parentElement.dataset.id}`)
          }) //This is in preperation to render player with correct assetid

        fetch('https://tv4-graphql-prod.herokuapp.com/graphql?query={newsPlayer%20{assets%20{%20id%20program_nid%20description}}}')
          .then(function (response) {
              return response.json();
          })
          .then(function (json) {
              displayListings(json.data)
          });
  })

    </script>

  </body>
</html>
